"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var c,o=e[Symbol.iterator]();!(n=(c=o.next()).done)&&(a.push(c.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw s}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},e=React.createElement,useState=React.useState,useEffect=React.useEffect;function Home(){var e=useState(!0),t=_slicedToArray(e,2),a=t[0],n=t[1],r=useState(!0),s=_slicedToArray(r,2),c=s[0],o=s[1],i=useState(""),l=_slicedToArray(i,2),m=l[0],u=l[1],d=useState(!1),f=_slicedToArray(d,2),g=f[0],h=f[1],R=useState(!1),E=_slicedToArray(R,2),p=E[0],y=E[1],w=useState("提示"),S=_slicedToArray(w,2),v=S[0],b=S[1];function A(e){"1"==e?n(!a):o(!c)}function N(){sessionStorage.setItem("agree1",a),sessionStorage.setItem("agree2",c),location.href="./sign.html"}function C(e){y(!0),b(e);var t=setTimeout((function(){y(!1),clearTimeout(t)}),2e3)}return useEffect((function(){var e,t,a=sessionStorage.getItem("datapair"),r=(e=new RegExp("(^|&)"+"token"+"=([^&]*)(&|$)","i"),null!==(t=window.location.search.substr(1).match(e))?unescape(t[2]):"");r&&(sessionStorage.setItem("token",r),function(e){fetch(window.g.api+"/electronic/agreement/queryInfo",{method:"POST",headers:new Headers({Authorization:e})}).then((function(e){return e.json()})).catch((function(e){console.error(e),C("网络错误"),h(!1)})).then((function(e){h(!1),console.log(e),"ERROR"==e.status&&(C(e.message),"该协议已签署"==e.message&&(location.href="./success.html"))}))}(r));var s=sessionStorage.getItem("agree1"),c=sessionStorage.getItem("agree2");"false"==s&&n(!1),"false"==c&&o(!1),u(a)}),[]),React.createElement("div",{className:"home"},p?React.createElement("div",{className:"toast toastAnimate"},React.createElement("span",{className:"txt"},v)):null,g?React.createElement("div",{className:"mask",id:"mask"},React.createElement("div",{class:"donut"})):null,React.createElement("p",null,"以下為商戶入網協議及KYC協議，請貴司董事認真查閲並完成綫上簽約"),React.createElement("div",{className:"agree"},React.createElement("label",{className:"labelId",onClick:A.bind(this,1)},a?React.createElement("span",{className:"regular"}):null),React.createElement("a",{href:window.g.bindo,target:"_blank",className:"txt"},"Bindo Payment Services Agreement")),React.createElement("div",{className:"agree"},React.createElement("label",{className:"labelId",onClick:A.bind(this,2)},c?React.createElement("span",{className:"regular"}):null),React.createElement("a",{href:window.g.kyc,target:"_blank",className:"txt"},"Merchant KYC infomation Form for Credit Card. Alipay and WeChat Pay Payment Application")),React.createElement("div",{className:"warp"},React.createElement("span",{className:"txt"},"董事簽字:"),m?React.createElement("img",{src:m,className:"signContent",onClick:N}):React.createElement("span",{className:"signContent",onClick:N})),React.createElement("div",{className:"btn"},React.createElement("span",{className:"btn-item",onClick:function(){if(a||c)C("請先勾選協議");else if(m){h(!0);var e,t,n,r=new FormData,s=function(e){var t=e.split(","),a=t[0].match(/:(.*?);/)[1],n=atob(t[1]),r=n.length,s=new Uint8Array(r);for(;r--;)s[r]=n.charCodeAt(r);return new Blob([s],{type:a})}(m),o=(t="sign",(e=s).lastModifiedDate=new Date,e.name=t,e);r.append("file",o),n=r,fetch(window.g.api+"/electronic/agreement/updateStatus",{method:"POST",body:n,headers:new Headers({Authorization:sessionStorage.getItem("token")})}).then((function(e){return e.json()})).catch((function(e){console.error(e),C("网络错误"),h(!1)})).then((function(e){h(!1),"ERROR"==e.status?C(e.message):(C("签署协议成功"),location.href="./success.html")}))}else C("請先签字")}},"同意協議")),React.createElement("p",{class:"point",onClick:function(){fetch(window.g.api+"/electronic/agreement/sendMail",{method:"POST",headers:new Headers({Authorization:sessionStorage.getItem("token")})}).then((function(e){return e.json()})).catch((function(e){console.error(e),C("网络错误"),h(!1)})).then((function(e){h(!1),console.log(e),e.status,C(e.message)}))}},"?⃝對協議有疑問"))}var domContainer=document.querySelector("#home");ReactDOM.render(e(Home),domContainer);